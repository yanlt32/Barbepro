<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>BarbaPRO Duo - Dashboard</title>
  <meta name="theme-color" content="#ffaa00" />
  <link rel="shortcut icon" href="image.png" type="image/x-icon">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
/* BarbaPRO Dashboard - CSS Otimizado */
:root {
  --primary: #ffaa00;
  --primary-dark: #ff5500;
  --secondary: #16213e;
  --dark: #0a0a0a;
  --light: #ffffff;
  --gray: #aaaaaa;
  --success: #25D366;
  --danger: #ff3366;
  --info: #3366ff;
  --warning: #ff9500;
  --purple: #9933ff;
  
  --card-bg: rgba(255, 255, 255, 0.06);
  --card-border: rgba(255, 170, 0, 0.08);
  --card-shadow: 0 8px 32px rgba(255, 170, 0, 0.06);
  
  --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
  --border-radius: 16px;
  --border-radius-sm: 12px;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  -webkit-tap-highlight-color: transparent;
  touch-action: manipulation;
}

html, body {
  height: 100%;
  background: linear-gradient(135deg, var(--dark) 0%, var(--secondary) 100%);
  color: var(--light);
  font-family: 'Inter', sans-serif;
  overflow-x: hidden;
  scroll-behavior: smooth;
}

.container {
  max-width: 900px;
  margin: 0 auto;
  padding: 25px 20px;
}

/* Header */
/* Header - Estilo Profissional Barbearia */
.header {
  text-align: center;
  margin-bottom: 30px;
  position: relative;
  padding: 20px 0;
  background: linear-gradient(135deg, var(--dark) 0%, var(--dark-secondary) 100%);
  border-radius: 15px;
  border: 2px solid var(--gold);
  box-shadow: 0 8px 32px rgba(212, 175, 55, 0.15);
}

h1 {
  font-family: 'Playfair Display', 'Times New Roman', serif;
  font-size: clamp(52px, 11vw, 85px);
  color: var(--gold);
  margin: 10px 0 5px;
  letter-spacing: 4px;
  text-shadow: 
    0 2px 4px rgba(0, 0, 0, 0.5),
    0 4px 12px rgba(212, 175, 55, 0.3);
  font-weight: 700;
  position: relative;
  display: inline-block;
}

h1::before {
  content: '‚úÇÔ∏è';
  position: absolute;
  left: -40px;
  top: 50%;
  transform: translateY(-50%);
  font-size: 30px;
}

h1::after {
  content: 'üíà';
  position: absolute;
  right: -40px;
  top: 50%;
  transform: translateY(-50%);
  font-size: 30px;
}

.subtitle {
  color: var(--gold-light);
  font-size: clamp(18px, 4.5vw, 22px);
  margin-bottom: 8px;
  font-weight: 400;
  letter-spacing: 2px;
  text-transform: uppercase;
  font-family: 'Montserrat', sans-serif;
}

/* Cards */
.card {
  background: var(--card-bg);
  backdrop-filter: blur(8px);
  border-radius: var(--border-radius);
  padding: 22px;
  margin: 15px 0;
  box-shadow: var(--card-shadow);
  border: 1px solid var(--card-border);
  transition: var(--transition);
  position: relative;
  overflow: hidden;
}

.card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 3px;
  background: linear-gradient(90deg, var(--primary), var(--primary-dark));
  transform: scaleX(0);
  transform-origin: left;
  transition: transform 0.5s ease;
}

.card:hover::before {
  transform: scaleX(1);
}

.card:hover {
  transform: translateY(-5px);
  box-shadow: 0 12px 40px rgba(255, 170, 0, 0.1);
}

/* Section Titles */
.section-title {
  font-size: clamp(20px, 5vw, 24px);
  margin: 18px 0 12px;
  color: var(--primary);
  font-weight: 700;
  display: flex;
  align-items: center;
  gap: 12px;
}

.section-title::after {
  content: '';
  flex: 1;
  height: 2px;
  background: linear-gradient(90deg, var(--primary), transparent);
}

/* Buttons */
.btn {
  width: 100%;
  padding: 16px;
  margin: 12px 0;
  border: none;
  border-radius: var(--border-radius-sm);
  font-size: clamp(16px, 4.5vw, 18px);
  font-weight: 700;
  cursor: pointer;
  transition: var(--transition);
  box-shadow: 0 6px 18px rgba(0, 0, 0, 0.35);
  position: relative;
  overflow: hidden;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  min-height: 54px;
  touch-action: manipulation;
  -webkit-user-select: none;
  -moz-user-select: none;
  user-select: none;
  letter-spacing: 0.5px;
}

.btn::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
  transition: left 0.5s ease;
}

.btn:hover::before {
  left: 100%;
}

.btn:active {
  transform: scale(0.95);
}

.voltar {
  background: linear-gradient(45deg, var(--info), #0033cc);
  color: var(--light);
}

.whatsapp {
  background: linear-gradient(45deg, var(--success), #128C7E);
  color: var(--light);
}

.resumo {
  background: linear-gradient(45deg, var(--purple), #6600cc);
  color: var(--light);
}

.despesas {
  background: linear-gradient(45deg, var(--danger), #cc0033);
  color: var(--light);
}

.config {
  background: linear-gradient(45deg, #00aaff, #0066cc);
  color: var(--light);
}

.pagamentos {
  background: linear-gradient(45deg, var(--primary), #ff7733);
  color: var(--dark);
}

.mensalistas {
  background: linear-gradient(45deg, #00cc99, #009966);
  color: var(--light);
}

/* Stats Container */
.stats-container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  margin: 20px 0;
  gap: 15px;
}

.stat-card {
  flex: 1 1 calc(50% - 15px);
  background: rgba(255, 255, 255, 0.05);
  border-radius: var(--border-radius-sm);
  padding: 18px;
  text-align: center;
  border: 1px solid rgba(255, 255, 255, 0.05);
  position: relative;
  min-height: 110px;
  display: flex;
  flex-direction: column;
  justify-content: center;
  touch-action: manipulation;
  transition: var(--transition);
  overflow: hidden;
}

.stat-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: linear-gradient(135deg, rgba(255, 170, 0, 0.05), transparent);
  opacity: 0;
  transition: opacity 0.3s ease;
}

.stat-card:hover::before {
  opacity: 1;
}

.stat-card:hover {
  transform: translateY(-3px);
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
}

.stat-value {
  font-size: clamp(18px, 4.5vw, 22px);
  font-weight: 700;
  color: var(--primary);
  margin-bottom: 8px;
}

.stat-label {
  font-size: 14px;
  color: var(--gray);
}

/* Barbeiro Stats */
.barbeiro-stats {
  display: flex;
  gap: 15px;
  margin: 20px 0;
}

.barbeiro-card {
  flex: 1;
  background: rgba(255, 255, 255, 0.05);
  border-radius: var(--border-radius-sm);
  padding: 20px;
  text-align: center;
  border: 1px solid rgba(255, 255, 255, 0.05);
  transition: var(--transition);
}

.barbeiro-card:hover {
  transform: translateY(-3px);
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
}

.barbeiro-nome {
  font-size: 18px;
  font-weight: 700;
  margin-bottom: 15px;
  color: var(--primary);
  position: relative;
  display: inline-block;
}

.barbeiro-nome::after {
  content: '';
  position: absolute;
  bottom: -5px;
  left: 0;
  width: 100%;
  height: 2px;
  background: var(--primary);
  transform: scaleX(0);
  transition: transform 0.3s ease;
}

.barbeiro-card:hover .barbeiro-nome::after {
  transform: scaleX(1);
}

.barbeiro-detalhes {
  font-size: 14px;
  color: #ccc;
  line-height: 1.6;
}

/* Tables */
table {
  width: 100%;
  border-collapse: collapse;
  margin: 15px 0;
  font-size: clamp(14px, 3.5vw, 16px);
  touch-action: manipulation;
  border-radius: var(--border-radius-sm);
  overflow: hidden;
}

th, td {
  border: 1px solid rgba(255, 170, 0, 0.3);
  padding: 12px;
  text-align: center;
  min-height: 44px;
}

th {
  background: rgba(255, 170, 0, 0.12);
  font-weight: 700;
  color: var(--primary);
}

tr:nth-child(even) {
  background: rgba(255, 255, 255, 0.02);
}

tr:hover {
  background: rgba(255, 170, 0, 0.05);
}

/* Modals */
.modal {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.92);
  z-index: 1000;
  align-items: center;
  justify-content: center;
  padding: 25px;
  backdrop-filter: blur(5px);
  touch-action: manipulation;
  animation: fadeIn 0.3s ease;
}

.modal-content {
  background: rgba(30, 30, 30, 0.98);
  border-radius: var(--border-radius);
  padding: 25px;
  width: 100%;
  max-width: 600px;
  max-height: 90vh;
  overflow-y: auto;
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
  border: 1px solid rgba(255, 170, 0, 0.1);
  animation: modalAppear 0.3s ease;
}

@keyframes modalAppear {
  from {
    opacity: 0;
    transform: translateY(-20px) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

/* Form Elements */
input, select {
  width: 100%;
  padding: 16px;
  margin: 12px 0;
  border-radius: var(--border-radius-sm);
  border: 1px solid rgba(255, 255, 255, 0.1);
  background: rgba(0, 0, 0, 0.3);
  color: var(--light);
  font-family: 'Inter', sans-serif;
  font-size: 16px;
  min-height: 50px;
  touch-action: manipulation;
  transition: var(--transition);
}

input:focus, select:focus {
  outline: none;
  border-color: var(--primary);
  box-shadow: 0 0 0 2px rgba(255, 170, 0, 0.2);
  transform: translateY(-2px);
}

label {
  display: block;
  margin-top: 18px;
  margin-bottom: 8px;
  font-weight: 500;
  color: #ccc;
  font-size: 16px;
}

.modal-buttons {
  display: flex;
  gap: 15px;
  margin-top: 20px;
}

.modal-buttons .btn {
  margin: 0;
  flex: 1;
  padding: 16px;
  min-height: 54px;
}

/* Animations */
.fade-in {
  animation: fadeIn 0.5s ease;
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Status Bar & Home Indicator */
.status-bar {
  height: 44px;
  background: rgba(0, 0, 0, 0.5);
  backdrop-filter: blur(10px);
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  z-index: 999;
  display: flex;
  align-items: center;
  justify-content: center;
  border-bottom: 1px solid rgba(255, 170, 0, 0.1);
}

.status-time {
  font-weight: 600;
  font-size: 15px;
  color: var(--primary);
}

.home-indicator {
  height: 34px;
  background: rgba(0, 0, 0, 0.5);
  backdrop-filter: blur(10px);
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  z-index: 999;
  display: flex;
  align-items: center;
  justify-content: center;
  border-top: 1px solid rgba(255, 170, 0, 0.1);
}

.home-line {
  width: 134px;
  height: 5px;
  background: var(--primary);
  border-radius: 3px;
  opacity: 0.7;
}

/* Status Classes */
.servico-pago {
  color: var(--success);
  font-weight: 600;
}

.servico-fiado {
  color: var(--warning);
  font-weight: 600;
}

/* Despesas */
.despesa-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 12px;
  background: rgba(255, 50, 50, 0.1);
  margin: 8px 0;
  border-radius: 10px;
  border-left: 4px solid var(--danger);
  transition: var(--transition);
}

.despesa-item:hover {
  transform: translateX(5px);
  background: rgba(255, 50, 50, 0.15);
}

.despesa-valor {
  color: var(--danger);
  font-weight: 600;
}

/* Calend√°rio */
.calendario-container {
  display: flex;
  gap: 10px;
  margin-bottom: 15px;
  flex-wrap: wrap;
}

.calendario-container input {
  flex: 1;
  min-width: 140px;
}

/* Gr√°fico */
.grafico-container {
  width: 100%;
  max-width: 400px;
  margin: 20px auto;
  height: 300px;
}

/* Info Box */
.info-box {
  background: rgba(255, 255, 255, 0.05);
  border-radius: var(--border-radius-sm);
  padding: 15px;
  margin: 10px 0;
  border-left: 4px solid var(--primary);
  transition: var(--transition);
}

.info-box:hover {
  transform: translateX(5px);
}

.info-box h4 {
  color: var(--primary);
  margin-bottom: 8px;
}

/* Resumo Pagamentos */
.resumo-pagamentos {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 15px;
  margin: 20px 0;
}

.resumo-pagamento-card {
  background: rgba(255, 255, 255, 0.05);
  border-radius: var(--border-radius-sm);
  padding: 18px;
  text-align: center;
  border: 1px solid rgba(255, 255, 255, 0.05);
  transition: var(--transition);
  position: relative;
  overflow: hidden;
}

.resumo-pagamento-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: linear-gradient(135deg, rgba(255, 255, 255, 0.05), transparent);
  opacity: 0;
  transition: opacity 0.3s ease;
}

.resumo-pagamento-card:hover::before {
  opacity: 1;
}

.resumo-pagamento-card:hover {
  transform: translateY(-3px);
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
}

.resumo-pagamento-valor {
  font-size: 20px;
  font-weight: 700;
  color: var(--primary);
  margin: 8px 0;
}

.resumo-pagamento-label {
  font-size: 14px;
  color: var(--gray);
}

/* Servi√ßos por Tipo */
.servico-resumo-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 10px;
  margin: 15px 0;
}

.servico-resumo-item {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 10px;
  padding: 12px;
  text-align: center;
  border: 1px solid rgba(255, 255, 255, 0.05);
  transition: var(--transition);
}

.servico-resumo-item:hover {
  transform: translateY(-3px);
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
}

.servico-resumo-tipo {
  font-size: 12px;
  color: var(--primary);
  font-weight: 600;
  margin-bottom: 5px;
}

.servico-resumo-detalhes {
  font-size: 11px;
  color: #ccc;
  line-height: 1.4;
}

/* Compara√ß√£o Barbeiros */
.barbeiro-comparacao {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 15px;
  margin: 20px 0;
}

.barbeiro-metodos {
  background: rgba(255, 255, 255, 0.05);
  border-radius: var(--border-radius-sm);
  padding: 15px;
  border: 1px solid rgba(255, 255, 255, 0.05);
  transition: var(--transition);
}

.barbeiro-metodos:hover {
  transform: translateY(-3px);
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
}

.barbeiro-metodos-nome {
  font-size: 16px;
  font-weight: 700;
  color: var(--primary);
  margin-bottom: 10px;
  text-align: center;
}

.metodo-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 8px 0;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  transition: var(--transition);
}

.metodo-item:hover {
  background: rgba(255, 255, 255, 0.03);
  border-radius: 5px;
  padding-left: 5px;
  padding-right: 5px;
}

.metodo-item:last-child {
  border-bottom: none;
}

.metodo-info {
  display: flex;
  align-items: center;
  gap: 8px;
}

.metodo-valor {
  font-weight: 600;
  color: var(--primary);
}

/* Action Buttons */
.action-btn {
  background: var(--danger);
  color: white;
  border: none;
  border-radius: 8px;
  width: 36px;
  height: 36px;
  font-size: 16px;
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  transition: var(--transition);
  min-height: 36px;
  min-width: 36px;
  touch-action: manipulation;
}

.action-btn:hover {
  background: #ff0044;
  transform: scale(1.05);
}

.action-btn:active {
  background: #ff0044;
  transform: scale(0.95);
}

/* Se√ß√£o Mensalistas */
.mensalistas-section {
  margin: 20px 0;
}

.mensalista-card {
  background: rgba(255, 255, 255, 0.05);
  border-radius: var(--border-radius-sm);
  padding: 18px;
  margin: 12px 0;
  border: 1px solid rgba(255, 170, 0, 0.2);
  transition: var(--transition);
}

.mensalista-card:hover {
  transform: translateY(-3px);
  box-shadow: 0 5px 15px rgba(255, 170, 0, 0.1);
}

.mensalista-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 12px;
}

.mensalista-nome {
  font-size: 18px;
  font-weight: 700;
  color: var(--primary);
}

.mensalista-status {
  padding: 4px 12px;
  border-radius: 20px;
  font-size: 12px;
  font-weight: 600;
}

.status-pago {
  background: rgba(37, 211, 102, 0.2);
  color: var(--success);
}

.status-pendente {
  background: rgba(255, 149, 0, 0.2);
  color: var(--warning);
}

.mensalista-detalhes {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 10px;
  font-size: 14px;
  color: #ccc;
}

.mensalista-valor {
  font-weight: 600;
  color: var(--primary);
}

/* Modal Mensalistas */
.mensalista-form {
  display: flex;
  flex-direction: column;
  gap: 15px;
}

.form-row {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 15px;
}

/* Responsividade */
@media (min-width: 768px) and (max-width: 1024px) {
  .container {
    max-width: 95%;
    padding: 30px 25px;
  }
  
  .stats-container {
    gap: 20px;
    margin: 25px 0;
  }
  
  .stat-card {
    padding: 22px 18px;
    min-height: 120px;
  }
  
  .stat-value {
    font-size: 24px;
  }
  
  .btn {
    padding: 18px;
    font-size: 18px;
    min-height: 60px;
  }
  
  .card {
    padding: 25px;
  }
  
  table {
    font-size: 16px;
  }
  
  th, td {
    padding: 14px;
  }
  
  .servico-resumo-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 12px;
  }
  
  .barbeiro-comparacao {
    grid-template-columns: repeat(2, 1fr);
    gap: 20px;
  }
}

@media (max-width: 767px) {
  .barbeiro-stats {
    flex-direction: column;
  }
  
  .resumo-pagamentos {
    grid-template-columns: 1fr;
  }
  
  .barbeiro-comparacao {
    grid-template-columns: 1fr;
  }
  
  .servico-resumo-grid {
    grid-template-columns: 1fr;
  }
  
  .modal-buttons {
    flex-direction: column;
  }
  
  .calendario-container {
    flex-direction: column;
  }
  
  .form-row {
    grid-template-columns: 1fr;
  }
  
  .mensalista-detalhes {
    grid-template-columns: 1fr;
  }
}
  </style>
</head>
<body>

  
  <div class="container fade-in">
    <div class="header">
      <h1>BarbaPRO</h1>
      <div class="subtitle">Dashboard Administrativo</div>
    </div>

    <div class="card">
      <button class="btn voltar" onclick="voltarParaRegistro()">VOLTAR PARA REGISTRO</button>
    </div>

    <div class="card">
      <h3 class="section-title">Estat√≠sticas dos Barbeiros</h3>
      <div class="barbeiro-stats">
        <div class="barbeiro-card">
          <div class="barbeiro-nome">GABRIEL</div>
          <div class="barbeiro-detalhes">
            <div>Hoje: <span id="gabrielHoje">0</span> servi√ßos</div>
            <div>Total: R$ <span id="gabrielTotal">0,00</span></div>
            <div>Fiado: R$ <span id="gabrielFiado">0,00</span></div>
            <div>Servi√ßos do M√™s: <span id="gabrielMes">0</span></div>
          </div>
        </div>
        <div class="barbeiro-card">
          <div class="barbeiro-nome">WAGNER</div>
          <div class="barbeiro-detalhes">
            <div>Hoje: <span id="wagnerHoje">0</span> servi√ßos</div>
            <div>Total: R$ <span id="wagnerTotal">0,00</span></div>
            <div>Fiado: R$ <span id="wagnerFiado">0,00</span></div>
            <div>Servi√ßos do M√™s: <span id="wagnerMes">0</span></div>
          </div>
        </div>
      </div>
    </div>

    <div class="card">
      <h3 class="section-title">Resumo do Dia</h3>
      <div class="stats-container">
        <div class="stat-card">
          <div class="stat-value" id="totalHoje">R$ 0,00</div>
          <div class="stat-label">TOTAL HOJE</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="servicosHoje">0</div>
          <div class="stat-label">SERVI√áOS HOJE</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="fiadoHoje">R$ 0,00</div>
          <div class="stat-label">FIADO HOJE</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="despesasMes">R$ 0,00</div>
          <div class="stat-label">DESPESAS M√äS</div>
        </div>
      </div>
    </div>

    <div class="card">
      <h3 class="section-title">Resumo de Pagamentos</h3>
      <div class="resumo-pagamentos">
        <div class="resumo-pagamento-card">
          <div class="pagamento-icon">üíµ</div>
          <div class="resumo-pagamento-valor" id="totalDinheiro">R$ 0,00</div>
          <div class="resumo-pagamento-label">DINHEIRO</div>
        </div>
        <div class="resumo-pagamento-card">
          <div class="pagamento-icon">üì±</div>
          <div class="resumo-pagamento-valor" id="totalPix">R$ 0,00</div>
          <div class="resumo-pagamento-label">PIX</div>
        </div>
        <div class="resumo-pagamento-card">
          <div class="pagamento-icon">üí≥</div>
          <div class="resumo-pagamento-valor" id="totalDebito">R$ 0,00</div>
          <div class="resumo-pagamento-label">D√âBITO</div>
        </div>
        <div class="resumo-pagamento-card">
          <div class="pagamento-icon">üí≥</div>
          <div class="resumo-pagamento-valor" id="totalCredito">R$ 0,00</div>
          <div class="resumo-pagamento-label">CR√âDITO</div>
        </div>
      </div>
    </div>

    <div class="card">
      <h3 class="section-title">Compara√ß√£o por Barbeiro</h3>
      <div class="barbeiro-comparacao" id="comparacaoBarbeiros"></div>
    </div>

    <div class="card">
      <h3 class="section-title">Servi√ßos por Tipo</h3>
      <div class="servico-resumo-grid" id="servicosPorTipo"></div>
    </div>

    <!-- NOVA SE√á√ÉO: Mensalistas -->
    <div class="card">
      <h3 class="section-title">Mensalistas</h3>
      <div id="listaMensalistas"></div>
      <button class="btn mensalistas" onclick="abrirModalMensalistas()">GERENCIAR MENSALISTAS</button>
    </div>

    <div class="card">
      <h3 class="section-title">A√ß√µes</h3>
      <button class="btn whatsapp" onclick="enviarResumoWhatsApp()">ENVIAR RESUMO DO DIA</button>
      <button class="btn resumo" onclick="abrirModalResumo()">VER RESUMO COMPLETO</button>
      <button class="btn pagamentos" onclick="abrirModalPagamentos()">RELAT√ìRIO PAGAMENTOS</button>
      <button class="btn despesas" onclick="abrirModalDespesas()">DESPESAS</button>
      <button class="btn config" onclick="abrirModalConfiguracoes()">CONFIGURA√á√ïES</button>
    </div>

    <div class="card">
      <h3 class="section-title">Hist√≥rico de Servi√ßos</h3>
      <div class="calendario-container">
        <input type="date" id="dataInicio" />
        <input type="date" id="dataFim" />
        <button class="btn resumo" onclick="filtrarServicos()" style="padding: 10px 15px; min-height: auto;">FILTRAR</button>
      </div>
      <div id="listaServicosRecentes"></div>
    </div>

    <div class="card">
      <h3 class="section-title">Despesas do M√™s</h3>
      <div id="listaDespesasDashboard"></div>
    </div>
    
    <div class="card">
      <h3 class="section-title">Gr√°fico de Distribui√ß√£o</h3>
      <div class="grafico-container">
        <canvas id="graficoPizza"></canvas>
      </div>
    </div>
  </div>

  <div class="home-indicator">
    <div class="home-line"></div>
  </div>

  <!-- Modal Resumo Completo -->
  <div id="modalResumo" class="modal">
    <div class="modal-content">
      <h3 class="section-title">Resumo Completo</h3>
      <div id="conteudoResumo"></div>
      <div class="modal-buttons">
        <button class="btn voltar" onclick="fecharModal('modalResumo')">FECHAR</button>
      </div>
    </div>
  </div>

  <!-- Modal Relat√≥rio de Pagamentos -->
  <div id="modalPagamentos" class="modal">
    <div class="modal-content">
      <h3 class="section-title">Relat√≥rio de Pagamentos</h3>
      <div class="calendario-container">
        <input type="date" id="dataInicioPagamentos" />
        <input type="date" id="dataFimPagamentos" />
        <button class="btn pagamentos" onclick="filtrarPagamentos()" style="padding: 10px 15px; min-height: auto;">FILTRAR</button>
      </div>
      <div id="relatorioPagamentos"></div>
      <div class="modal-buttons">
        <button class="btn whatsapp" onclick="enviarRelatorioPagamentosWhatsApp()">ENVIAR POR WHATSAPP</button>
        <button class="btn voltar" onclick="fecharModal('modalPagamentos')">FECHAR</button>
      </div>
    </div>
  </div>

  <!-- Modal Despesas -->
  <div id="modalDespesas" class="modal">
    <div class="modal-content">
      <h3 class="section-title">Despesas do M√™s</h3>
      <div id="listaDespesas"></div>
      <input id="descDespesa" placeholder="Descri√ß√£o" maxlength="50" />
      <input id="valorDespesa" type="number" placeholder="Valor" min="0.01" step="0.01" />
      <div class="modal-buttons">
        <button class="btn despesas" onclick="adicionarDespesa()">ADICIONAR</button>
        <button class="btn voltar" onclick="fecharModal('modalDespesas')">FECHAR</button>
      </div>
    </div>
  </div>

  <!-- Modal Configura√ß√µes -->
  <div id="modalConfig" class="modal">
    <div class="modal-content">
      <h3 class="section-title">Configura√ß√µes</h3>
      
      <div class="info-box">
        <h4>Configura√ß√µes do WhatsApp</h4>
        <label>N√∫mero WhatsApp (s√≥ n√∫meros):</label>
        <input id="numWhats" placeholder="11962094589" maxlength="11" />
      </div>
      
      <div class="info-box">
        <h4>Alterar PIN de Seguran√ßa</h4>
        <label>Novo PIN (4 d√≠gitos):</label>
        <input id="novoPin" type="password" maxlength="4" placeholder="Novo PIN" />
      </div>
      
      <div class="info-box">
        <h4>Editar Valores dos Servi√ßos</h4>
        <p style="color:#aaa; margin-bottom:10px; font-size:14px;">Aqui voc√™ pode atualizar os valores cobrados por cada tipo de servi√ßo</p>
        
        <label>Corte de Cabelo (valor atual: R$ <span id="corteAtual">28,00</span>):</label>
        <input id="valCorte" type="number" placeholder="Novo valor para Corte" min="1" step="0.01" />
        
        <label>Barba (valor atual: R$ <span id="barbaAtual">15,00</span>):</label>
        <input id="valBarba" type="number" placeholder="Novo valor para Barba" min="1" step="0.01" />
        
        <label>Combo Barba + Cabelo (valor atual: R$ <span id="comboAtual">40,00</span>):</label>
        <input id="valCombo" type="number" placeholder="Novo valor para Combo" min="1" step="0.01" />
      </div>
      
      <div class="modal-buttons">
        <button class="btn config" onclick="salvarConfiguracoes()">SALVAR TUDO</button>
        <button class="btn voltar" onclick="fecharModal('modalConfig')">FECHAR</button>
      </div>
    </div>
  </div>

  <!-- NOVO MODAL: Mensalistas -->
  <div id="modalMensalistas" class="modal">
    <div class="modal-content">
      <h3 class="section-title">Gerenciar Mensalistas</h3>
      
      <div class="calendario-container">
        <input type="date" id="dataInicioMensalistas" />
        <input type="date" id="dataFimMensalistas" />
        <button class="btn mensalistas" onclick="filtrarMensalistas()" style="padding: 10px 15px; min-height: auto;">FILTRAR</button>
      </div>
      
      <div id="listaMensalistasModal"></div>
      
      <div class="info-box" style="margin-top: 20px;">
        <h4>Adicionar Novo Mensalista</h4>
        <div class="mensalista-form">
          <input id="nomeMensalista" placeholder="Nome do Cliente" maxlength="50" />
          <div class="form-row">
            <input id="valorMensalista" type="number" placeholder="Valor Mensal" min="1" step="0.01" />
            <input id="vencimentoMensalista" type="number" placeholder="Dia Vencimento (1-31)" min="1" max="31" />
          </div>
          <select id="statusMensalista">
            <option value="pago">Pago</option>
            <option value="pendente">Pendente</option>
          </select>
        </div>
      </div>
      
      <div class="modal-buttons">
        <button class="btn mensalistas" onclick="adicionarMensalista()">ADICIONAR MENSALISTA</button>
        <button class="btn voltar" onclick="fecharModal('modalMensalistas')">FECHAR</button>
      </div>
    </div>
  </div>

  <script>
    // Vari√°veis globais
    let dados = { 
      Gabriel: [], 
      Wagner: [], 
      despesas: [],
      mensalistas: []
    };
    
    let config = { 
      pin: '1234', 
      whatsapp: '11962094589', 
      corte: 28, 
      barba: 15, 
      combo: 40 
    };
    
    let graficoPizza = null;

    // Inicializa√ß√£o
    document.addEventListener('DOMContentLoaded', function() {
      carregarDados();
      atualizarDashboard();
      
      const hoje = new Date();
      const umaSemanaAtras = new Date();
      umaSemanaAtras.setDate(hoje.getDate() - 7);
      
      document.getElementById('dataInicio').value = umaSemanaAtras.toISOString().split('T')[0];
      document.getElementById('dataFim').value = hoje.toISOString().split('T')[0];
      
      const primeiroDiaMes = new Date(hoje.getFullYear(), hoje.getMonth(), 1);
      document.getElementById('dataInicioPagamentos').value = primeiroDiaMes.toISOString().split('T')[0];
      document.getElementById('dataFimPagamentos').value = hoje.toISOString().split('T')[0];
      
      document.getElementById('dataInicioMensalistas').value = primeiroDiaMes.toISOString().split('T')[0];
      document.getElementById('dataFimMensalistas').value = hoje.toISOString().split('T')[0];
    });

    // Fun√ß√µes principais ATUALIZADAS
    async function carregarDados() {
      try {
        const response = await fetch('/api/data');
        const result = await response.json();
        if (result.success) {
          Object.assign(dados, result.data);
          if (result.data.config) Object.assign(config, result.data.config);
          atualizarDashboard();
        }
      } catch (error) {
        console.log('Usando dados locais');
        const salvo = localStorage.getItem('barbapro_duo');
        if (salvo) {
          const temp = JSON.parse(salvo);
          Object.assign(dados, temp);
          if (temp.config) Object.assign(config, temp.config);
        }
      }
    }

    async function salvarDados() {
      try {
        const response = await fetch('/api/save', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ data: { ...dados, config } })
        });
        
        if (!response.ok) {
          throw new Error('Falha ao salvar no servidor');
        }
      } catch (error) {
        console.log('Salvando localmente');
        localStorage.setItem('barbapro_duo', JSON.stringify({ ...dados, config }));
      }
    }

    function atualizarDashboard() {
      atualizarEstatisticasBarbeiros();
      atualizarEstatisticasGerais();
      atualizarResumoPagamentos();
      atualizarComparacaoBarbeiros();
      atualizarServicosPorTipo();
      atualizarListaServicosRecentes();
      atualizarListaDespesas();
      atualizarListaMensalistas();
      atualizarGraficoPizza();
    }

    function atualizarEstatisticasBarbeiros() {
      const hoje = new Date().toISOString().split('T')[0];
      const mesAtual = new Date().getMonth();
      const anoAtual = new Date().getFullYear();
      
      // Gabriel
      const servicosGabrielHoje = dados.Gabriel.filter(s => s.data === hoje);
      const servicosGabrielMes = dados.Gabriel.filter(s => {
        const dataServico = new Date(s.data);
        return dataServico.getMonth() === mesAtual && dataServico.getFullYear() === anoAtual;
      });
      
      const totalGabrielHoje = servicosGabrielHoje.reduce((acc, s) => acc + s.valor, 0);
      const totalGabrielMes = servicosGabrielMes.reduce((acc, s) => acc + s.valor, 0);
      const fiadoGabrielHoje = servicosGabrielHoje.reduce((acc, s) => acc + (!s.pago ? s.valor : 0), 0);
      
      document.getElementById('gabrielHoje').textContent = servicosGabrielHoje.length;
      document.getElementById('gabrielTotal').textContent = totalGabrielHoje.toFixed(2);
      document.getElementById('gabrielFiado').textContent = fiadoGabrielHoje.toFixed(2);
      document.getElementById('gabrielMes').textContent = servicosGabrielMes.length;
      
      // Wagner
      const servicosWagnerHoje = dados.Wagner.filter(s => s.data === hoje);
      const servicosWagnerMes = dados.Wagner.filter(s => {
        const dataServico = new Date(s.data);
        return dataServico.getMonth() === mesAtual && dataServico.getFullYear() === anoAtual;
      });
      
      const totalWagnerHoje = servicosWagnerHoje.reduce((acc, s) => acc + s.valor, 0);
      const totalWagnerMes = servicosWagnerMes.reduce((acc, s) => acc + s.valor, 0);
      const fiadoWagnerHoje = servicosWagnerHoje.reduce((acc, s) => acc + (!s.pago ? s.valor : 0), 0);
      
      document.getElementById('wagnerHoje').textContent = servicosWagnerHoje.length;
      document.getElementById('wagnerTotal').textContent = totalWagnerHoje.toFixed(2);
      document.getElementById('wagnerFiado').textContent = fiadoWagnerHoje.toFixed(2);
      document.getElementById('wagnerMes').textContent = servicosWagnerMes.length;
    }

    function atualizarEstatisticasGerais() {
      const hoje = new Date().toISOString().split('T')[0];
      const servicosGabriel = dados.Gabriel.filter(s => s.data === hoje);
      const servicosWagner = dados.Wagner.filter(s => s.data === hoje);
      
      const totalPagoGabriel = servicosGabriel.reduce((acc, s) => acc + (s.pago ? s.valor : 0), 0);
      const totalPagoWagner = servicosWagner.reduce((acc, s) => acc + (s.pago ? s.valor : 0), 0);
      const totalFiadoGabriel = servicosGabriel.reduce((acc, s) => acc + (!s.pago ? s.valor : 0), 0);
      const totalFiadoWagner = servicosWagner.reduce((acc, s) => acc + (!s.pago ? s.valor : 0), 0);
      
      const totalHoje = totalPagoGabriel + totalPagoWagner;
      const totalServicosHoje = servicosGabriel.length + servicosWagner.length;
      const totalFiadoHoje = totalFiadoGabriel + totalFiadoWagner;
      
      const mesAtual = new Date().getMonth();
      const anoAtual = new Date().getFullYear();
      const despesasMes = dados.despesas.filter(d => {
        const dataDespesa = new Date(d.data);
        return dataDespesa.getMonth() === mesAtual && dataDespesa.getFullYear() === anoAtual;
      }).reduce((acc, d) => acc + d.valor, 0);
      
      document.getElementById('totalHoje').textContent = `R$ ${totalHoje.toFixed(2)}`;
      document.getElementById('servicosHoje').textContent = totalServicosHoje;
      document.getElementById('fiadoHoje').textContent = `R$ ${totalFiadoHoje.toFixed(2)}`;
      document.getElementById('despesasMes').textContent = `R$ ${despesasMes.toFixed(2)}`;
    }

    function atualizarResumoPagamentos() {
      const hoje = new Date().toISOString().split('T')[0];
      const todosServicosHoje = [
        ...dados.Gabriel.filter(s => s.data === hoje && s.pago),
        ...dados.Wagner.filter(s => s.data === hoje && s.pago)
      ];
      
      const totalDinheiro = todosServicosHoje
        .filter(s => s.metodoPagamento === 'dinheiro')
        .reduce((acc, s) => acc + s.valor, 0);
      
      const totalPix = todosServicosHoje
        .filter(s => s.metodoPagamento === 'pix')
        .reduce((acc, s) => acc + s.valor, 0);
      
      const totalDebito = todosServicosHoje
        .filter(s => s.metodoPagamento === 'debito')
        .reduce((acc, s) => acc + s.valor, 0);
      
      const totalCredito = todosServicosHoje
        .filter(s => s.metodoPagamento === 'credito')
        .reduce((acc, s) => acc + s.valor, 0);
      
      document.getElementById('totalDinheiro').textContent = `R$ ${totalDinheiro.toFixed(2)}`;
      document.getElementById('totalPix').textContent = `R$ ${totalPix.toFixed(2)}`;
      document.getElementById('totalDebito').textContent = `R$ ${totalDebito.toFixed(2)}`;
      document.getElementById('totalCredito').textContent = `R$ ${totalCredito.toFixed(2)}`;
    }

    function atualizarComparacaoBarbeiros() {
      const hoje = new Date().toISOString().split('T')[0];
      const servicosGabriel = dados.Gabriel.filter(s => s.data === hoje && s.pago);
      const servicosWagner = dados.Wagner.filter(s => s.data === hoje && s.pago);
      
      const gabrielMetodos = {
        dinheiro: servicosGabriel.filter(s => s.metodoPagamento === 'dinheiro').reduce((acc, s) => acc + s.valor, 0),
        pix: servicosGabriel.filter(s => s.metodoPagamento === 'pix').reduce((acc, s) => acc + s.valor, 0),
        debito: servicosGabriel.filter(s => s.metodoPagamento === 'debito').reduce((acc, s) => acc + s.valor, 0),
        credito: servicosGabriel.filter(s => s.metodoPagamento === 'credito').reduce((acc, s) => acc + s.valor, 0)
      };
      
      const wagnerMetodos = {
        dinheiro: servicosWagner.filter(s => s.metodoPagamento === 'dinheiro').reduce((acc, s) => acc + s.valor, 0),
        pix: servicosWagner.filter(s => s.metodoPagamento === 'pix').reduce((acc, s) => acc + s.valor, 0),
        debito: servicosWagner.filter(s => s.metodoPagamento === 'debito').reduce((acc, s) => acc + s.valor, 0),
        credito: servicosWagner.filter(s => s.metodoPagamento === 'credito').reduce((acc, s) => acc + s.valor, 0)
      };
      
      const container = document.getElementById('comparacaoBarbeiros');
      
      let html = `
        <div class="barbeiro-metodos">
          <div class="barbeiro-metodos-nome">GABRIEL</div>
          <div class="metodo-item">
            <div class="metodo-info">
              <span>üíµ</span>
              <span>Dinheiro:</span>
            </div>
            <div class="metodo-valor">R$ ${gabrielMetodos.dinheiro.toFixed(2)}</div>
          </div>
          <div class="metodo-item">
            <div class="metodo-info">
              <span>üì±</span>
              <span>PIX:</span>
            </div>
            <div class="metodo-valor">R$ ${gabrielMetodos.pix.toFixed(2)}</div>
          </div>
          <div class="metodo-item">
            <div class="metodo-info">
              <span>üí≥</span>
              <span>D√©bito:</span>
            </div>
            <div class="metodo-valor">R$ ${gabrielMetodos.debito.toFixed(2)}</div>
          </div>
          <div class="metodo-item">
            <div class="metodo-info">
              <span>üí≥</span>
              <span>Cr√©dito:</span>
            </div>
            <div class="metodo-valor">R$ ${gabrielMetodos.credito.toFixed(2)}</div>
          </div>
          <div class="metodo-item" style="margin-top:10px; padding-top:10px; border-top:2px solid #ffaa00;">
            <div class="metodo-info">
              <span>üí∞</span>
              <span style="font-weight:600;">TOTAL:</span>
            </div>
            <div class="metodo-valor" style="color:#25D366;">R$ ${(gabrielMetodos.dinheiro + gabrielMetodos.pix + gabrielMetodos.debito + gabrielMetodos.credito).toFixed(2)}</div>
          </div>
        </div>
        
        <div class="barbeiro-metodos">
          <div class="barbeiro-metodos-nome">WAGNER</div>
          <div class="metodo-item">
            <div class="metodo-info">
              <span>üíµ</span>
              <span>Dinheiro:</span>
            </div>
            <div class="metodo-valor">R$ ${wagnerMetodos.dinheiro.toFixed(2)}</div>
          </div>
          <div class="metodo-item">
            <div class="metodo-info">
              <span>üì±</span>
              <span>PIX:</span>
            </div>
            <div class="metodo-valor">R$ ${wagnerMetodos.pix.toFixed(2)}</div>
          </div>
          <div class="metodo-item">
            <div class="metodo-info">
              <span>üí≥</span>
              <span>D√©bito:</span>
            </div>
            <div class="metodo-valor">R$ ${wagnerMetodos.debito.toFixed(2)}</div>
          </div>
          <div class="metodo-item">
            <div class="metodo-info">
              <span>üí≥</span>
              <span>Cr√©dito:</span>
            </div>
            <div class="metodo-valor">R$ ${wagnerMetodos.credito.toFixed(2)}</div>
          </div>
          <div class="metodo-item" style="margin-top:10px; padding-top:10px; border-top:2px solid #ffaa00;">
            <div class="metodo-info">
              <span>üí∞</span>
              <span style="font-weight:600;">TOTAL:</span>
            </div>
            <div class="metodo-valor" style="color:#25D366;">R$ ${(wagnerMetodos.dinheiro + wagnerMetodos.pix + wagnerMetodos.debito + wagnerMetodos.credito).toFixed(2)}</div>
          </div>
        </div>
      `;
      
      container.innerHTML = html;
    }

    function atualizarServicosPorTipo() {
      const hoje = new Date().toISOString().split('T')[0];
      const todosServicosHoje = [
        ...dados.Gabriel.filter(s => s.data === hoje),
        ...dados.Wagner.filter(s => s.data === hoje)
      ];
      
      const servicosPorTipo = {};
      
      todosServicosHoje.forEach(servico => {
        if (!servicosPorTipo[servico.tipo]) {
          servicosPorTipo[servico.tipo] = {
            total: 0,
            dinheiro: 0,
            pix: 0,
            debito: 0,
            credito: 0,
            fiado: 0,
            count: 0
          };
        }
        
        servicosPorTipo[servico.tipo].total += servico.valor;
        servicosPorTipo[servico.tipo].count += 1;
        
        if (!servico.pago) {
          servicosPorTipo[servico.tipo].fiado += servico.valor;
        } else {
          switch(servico.metodoPagamento) {
            case 'dinheiro':
              servicosPorTipo[servico.tipo].dinheiro += servico.valor;
              break;
            case 'pix':
              servicosPorTipo[servico.tipo].pix += servico.valor;
              break;
            case 'debito':
              servicosPorTipo[servico.tipo].debito += servico.valor;
              break;
            case 'credito':
              servicosPorTipo[servico.tipo].credito += servico.valor;
              break;
          }
        }
      });
      
      const container = document.getElementById('servicosPorTipo');
      let html = '';
      
      Object.entries(servicosPorTipo).forEach(([tipo, dados]) => {
        html += `
          <div class="servico-resumo-item">
            <div class="servico-resumo-tipo">${tipo}</div>
            <div class="servico-resumo-detalhes">
              <div>Total: R$ ${dados.total.toFixed(2)}</div>
              <div>Qtd: ${dados.count}</div>
              ${dados.dinheiro > 0 ? `<div>üíµ: R$ ${dados.dinheiro.toFixed(2)}</div>` : ''}
              ${dados.pix > 0 ? `<div>üì±: R$ ${dados.pix.toFixed(2)}</div>` : ''}
              ${dados.debito > 0 ? `<div>üí≥: R$ ${dados.debito.toFixed(2)}</div>` : ''}
              ${dados.credito > 0 ? `<div>üí≥: R$ ${dados.credito.toFixed(2)}</div>` : ''}
              ${dados.fiado > 0 ? `<div>‚è∞: R$ ${dados.fiado.toFixed(2)}</div>` : ''}
            </div>
          </div>
        `;
      });
      
      if (html === '') {
        html = '<p style="text-align:center;color:#666;grid-column:1/-1;">Nenhum servi√ßo registrado hoje</p>';
      }
      
      container.innerHTML = html;
    }

    function atualizarListaServicosRecentes() {
      const dataInicio = document.getElementById('dataInicio').value;
      const dataFim = document.getElementById('dataFim').value;
      
      const container = document.getElementById('listaServicosRecentes');
      
      const todosServicos = [...dados.Gabriel, ...dados.Wagner];
      const servicosFiltrados = todosServicos.filter(s => {
        return s.data >= dataInicio && s.data <= dataFim;
      });
      
      servicosFiltrados.sort((a, b) => new Date(b.data + ' ' + b.hora) - new Date(a.data + ' ' + a.hora));
      
      if (servicosFiltrados.length === 0) {
        container.innerHTML = '<p style="text-align:center;color:#666;padding:30px;">Nenhum servi√ßo encontrado no per√≠odo selecionado</p>';
        return;
      }
      
      let html = `
        <table>
          <tr>
            <th>Data</th>
            <th>Barbeiro</th>
            <th>Servi√ßo</th>
            <th>Valor</th>
            <th>Pagamento</th>
            <th>Status</th>
            <th>A√ß√£o</th>
          </tr>
      `;
      
      servicosFiltrados.forEach((servico, index) => {
        const barbeiro = dados.Gabriel.includes(servico) ? 'Gabriel' : 'Wagner';
        const status = servico.pago ? 'PAGO' : 'FIADO';
        const statusClass = servico.pago ? 'servico-pago' : 'servico-fiado';
        
        let metodoIcon = '';
        switch(servico.metodoPagamento) {
          case 'dinheiro': metodoIcon = 'üíµ'; break;
          case 'pix': metodoIcon = 'üì±'; break;
          case 'debito': metodoIcon = 'üí≥'; break;
          case 'credito': metodoIcon = 'üí≥'; break;
          default: metodoIcon = '‚ö´';
        }
        
        html += `
          <tr>
            <td>${servico.data}</td>
            <td>${barbeiro}</td>
            <td>${servico.tipo}</td>
            <td>R$ ${servico.valor.toFixed(2)}</td>
            <td>${metodoIcon}</td>
            <td class="${statusClass}">${status}</td>
            <td>
              <button class="action-btn" onclick="excluirServico('${barbeiro}', ${index})">√ó</button>
            </td>
          </tr>
        `;
      });
      
      html += '</table>';
      container.innerHTML = html;
    }
    
    function filtrarServicos() {
      atualizarListaServicosRecentes();
    }

    async function excluirServico(barbeiro, index) {
      if (confirm('Tem certeza que deseja excluir este servi√ßo?')) {
        const servicosFiltrados = [...dados[barbeiro]];
        const servicoParaExcluir = servicosFiltrados[index];
        
        const indexOriginal = dados[barbeiro].findIndex(s => 
          s.data === servicoParaExcluir.data && 
          s.hora === servicoParaExcluir.hora && 
          s.tipo === servicoParaExcluir.tipo &&
          s.valor === servicoParaExcluir.valor
        );
        
        if (indexOriginal !== -1) {
          dados[barbeiro].splice(indexOriginal, 1);
          await salvarDados();
          atualizarListaServicosRecentes();
          atualizarDashboard();
          alert('Servi√ßo exclu√≠do com sucesso!');
        }
      }
    }

    function atualizarListaDespesas() {
      const container = document.getElementById('listaDespesasDashboard');
      
      if (dados.despesas.length === 0) {
        container.innerHTML = '<p style="text-align:center;color:#666;padding:30px;">Nenhuma despesa registrada</p>';
        return;
      }
      
      const despesasOrdenadas = [...dados.despesas].sort((a, b) => new Date(b.data) - new Date(a.data));
      
      let html = '';
      
      despesasOrdenadas.forEach(despesa => {
        html += `
          <div class="despesa-item">
            <div>
              <div style="font-weight:600;">${despesa.desc}</div>
              <div style="font-size:12px;color:#aaa;">${despesa.data}</div>
            </div>
            <div class="despesa-valor">R$ ${despesa.valor.toFixed(2)}</div>
          </div>
        `;
      });
      
      container.innerHTML = html;
    }
    
    function atualizarListaMensalistas() {
      const container = document.getElementById('listaMensalistas');
      
      if (dados.mensalistas.length === 0) {
        container.innerHTML = '<p style="text-align:center;color:#666;padding:30px;">Nenhum mensalista cadastrado</p>';
        return;
      }
      
      const mesAtual = new Date().getMonth();
      const anoAtual = new Date().getFullYear();
      const mensalistasMes = dados.mensalistas.filter(m => {
        const dataMensalista = new Date(m.dataInicio);
        return dataMensalista.getMonth() === mesAtual && dataMensalista.getFullYear() === anoAtual;
      });
      
      if (mensalistasMes.length === 0) {
        container.innerHTML = '<p style="text-align:center;color:#666;padding:30px;">Nenhum mensalista ativo este m√™s</p>';
        return;
      }
      
      let html = '';
      
      mensalistasMes.forEach(mensalista => {
        const statusClass = mensalista.status === 'pago' ? 'status-pago' : 'status-pendente';
        const statusText = mensalista.status === 'pago' ? 'PAGO' : 'PENDENTE';
        
        html += `
          <div class="mensalista-card">
            <div class="mensalista-header">
              <div class="mensalista-nome">${mensalista.nome}</div>
              <div class="mensalista-status ${statusClass}">${statusText}</div>
            </div>
            <div class="mensalista-detalhes">
              <div>Valor: <span class="mensalista-valor">R$ ${mensalista.valor.toFixed(2)}</span></div>
              <div>Vencimento: dia ${mensalista.vencimento}</div>
              <div>In√≠cio: ${formatarDataBrasileira(mensalista.dataInicio)}</div>
              <div>Status: ${mensalista.status === 'pago' ? '‚úÖ Pago' : '‚è≥ Pendente'}</div>
            </div>
          </div>
        `;
      });
      
      container.innerHTML = html;
    }
    
    function atualizarGraficoPizza() {
      const ctx = document.getElementById('graficoPizza').getContext('2d');
      
      if (graficoPizza) {
        graficoPizza.destroy();
      }
      
      const hoje = new Date().toISOString().split('T')[0];
      const servicosGabriel = dados.Gabriel.filter(s => s.data === hoje);
      const servicosWagner = dados.Wagner.filter(s => s.data === hoje);
      
      const totalGabriel = servicosGabriel.reduce((acc, s) => acc + s.valor, 0);
      const totalWagner = servicosWagner.reduce((acc, s) => acc + s.valor, 0);
      const totalFiado = servicosGabriel.reduce((acc, s) => acc + (!s.pago ? s.valor : 0), 0) + 
                         servicosWagner.reduce((acc, s) => acc + (!s.pago ? s.valor : 0), 0);
      
      graficoPizza = new Chart(ctx, {
        type: 'pie',
        data: {
          labels: ['Gabriel', 'Wagner', 'Fiado'],
          datasets: [{
            data: [totalGabriel, totalWagner, totalFiado],
            backgroundColor: ['#ffaa00', '#3366ff', '#ff3366'],
            borderColor: '#0a0a0a',
            borderWidth: 2
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              position: 'bottom',
              labels: { color: '#fff', font: { size: 14 } }
            },
            tooltip: {
              callbacks: {
                label: function(context) {
                  const label = context.label || '';
                  const value = context.raw || 0;
                  const total = context.dataset.data.reduce((a, b) => a + b, 0);
                  const percentage = Math.round((value / total) * 100);
                  return `${label}: R$ ${value.toFixed(2)} (${percentage}%)`;
                }
              }
            }
          }
        }
      });
    }

    // Fun√ß√µes de navega√ß√£o
    function voltarParaRegistro() {
      window.location.href = '/';
    }

    // Fun√ß√µes de modais
    function abrirModalResumo() {
      document.getElementById('modalResumo').style.display = 'flex';
      exibirResumoCompleto();
    }

    function exibirResumoCompleto() {
      const resumo = calcularResumoCompleto();
      const container = document.getElementById('conteudoResumo');
      
      const mesAtual = new Date().getMonth();
      const anoAtual = new Date().getFullYear();
      
      const servicosGabrielMes = dados.Gabriel.filter(s => {
        const dataServico = new Date(s.data);
        return dataServico.getMonth() === mesAtual && dataServico.getFullYear() === anoAtual;
      });
      
      const servicosWagnerMes = dados.Wagner.filter(s => {
        const dataServico = new Date(s.data);
        return dataServico.getMonth() === mesAtual && dataServico.getFullYear() === anoAtual;
      });
      
      const totalGabrielMes = servicosGabrielMes.reduce((acc, s) => acc + s.valor, 0);
      const totalWagnerMes = servicosWagnerMes.reduce((acc, s) => acc + s.valor, 0);
      
      const despesasMes = dados.despesas.filter(d => {
        const dataDespesa = new Date(d.data);
        return dataDespesa.getMonth() === mesAtual && dataDespesa.getFullYear() === anoAtual;
      }).reduce((acc, d) => acc + d.valor, 0);
      
      const lucroMes = (totalGabrielMes + totalWagnerMes) - despesasMes;
      
      const hoje = new Date().toISOString().split('T')[0];
      const servicosHoje = [
        ...dados.Gabriel.filter(s => s.data === hoje),
        ...dados.Wagner.filter(s => s.data === hoje)
      ];
      
      const detalhesServicos = {};
      
      servicosHoje.forEach(servico => {
        if (!detalhesServicos[servico.tipo]) {
          detalhesServicos[servico.tipo] = {
            total: 0,
            dinheiro: 0,
            pix: 0,
            debito: 0,
            credito: 0,
            fiado: 0,
            count: 0
          };
        }
        
        detalhesServicos[servico.tipo].total += servico.valor;
        detalhesServicos[servico.tipo].count += 1;
        
        if (!servico.pago) {
          detalhesServicos[servico.tipo].fiado += servico.valor;
        } else {
          switch(servico.metodoPagamento) {
            case 'dinheiro':
              detalhesServicos[servico.tipo].dinheiro += servico.valor;
              break;
            case 'pix':
              detalhesServicos[servico.tipo].pix += servico.valor;
              break;
            case 'debito':
              detalhesServicos[servico.tipo].debito += servico.valor;
              break;
            case 'credito':
              detalhesServicos[servico.tipo].credito += servico.valor;
              break;
          }
        }
      });
      
      let detalhesHTML = '';
      Object.entries(detalhesServicos).forEach(([tipo, dados]) => {
        detalhesHTML += `
          <div style="margin-bottom:15px; padding:12px; background:rgba(255,255,255,0.05); border-radius:8px;">
            <div style="font-weight:600; color:#ffaa00; margin-bottom:8px;">${tipo}</div>
            <div style="display:grid; grid-template-columns:repeat(2,1fr); gap:5px; font-size:12px;">
              <div>Total: R$ ${dados.total.toFixed(2)}</div>
              <div>Quantidade: ${dados.count}</div>
              ${dados.dinheiro > 0 ? `<div>üíµ Dinheiro: R$ ${dados.dinheiro.toFixed(2)}</div>` : ''}
              ${dados.pix > 0 ? `<div>üì± PIX: R$ ${dados.pix.toFixed(2)}</div>` : ''}
              ${dados.debito > 0 ? `<div>üí≥ D√©bito: R$ ${dados.debito.toFixed(2)}</div>` : ''}
              ${dados.credito > 0 ? `<div>üí≥ Cr√©dito: R$ ${dados.credito.toFixed(2)}</div>` : ''}
              ${dados.fiado > 0 ? `<div>‚è∞ Fiado: R$ ${dados.fiado.toFixed(2)}</div>` : ''}
            </div>
          </div>
        `;
      });
      
      const html = `
        <div style="background:rgba(255,255,255,0.05);border-radius:12px;padding:20px;margin:15px 0;border-left:4px solid #ffaa00;">
          <h4 style="color:#ffaa00; margin-bottom:15px;">RESUMO DO DIA - ${new Date().toLocaleDateString('pt-BR')}</h4>
          
          <div style="display:flex; gap:15px; flex-wrap:wrap;">
            <div style="flex:1; min-width:200px;">
              <h5 style="color:#ffaa00; margin-bottom:10px;">GABRIEL</h5>
              <div style="font-size:16px; margin-bottom:5px;">Recebido: <span style="color:#25D366; font-weight:600;">R$ ${resumo.gabriel.totalPago.toFixed(2)}</span></div>
              <div style="font-size:16px; margin-bottom:5px;">Fiado: <span style="color:#FF9500; font-weight:600;">R$ ${resumo.gabriel.totalFiado.toFixed(2)}</span></div>
              <div style="font-size:16px; margin-bottom:5px;">Servi√ßos: <span style="font-weight:600;">${resumo.gabriel.totalServicos}</span></div>
            </div>
            
            <div style="flex:1; min-width:200px;">
              <h5 style="color:#ffaa00; margin-bottom:10px;">WAGNER</h5>
              <div style="font-size:16px; margin-bottom:5px;">Recebido: <span style="color:#25D366; font-weight:600;">R$ ${resumo.wagner.totalPago.toFixed(2)}</span></div>
              <div style="font-size:16px; margin-bottom:5px;">Fiado: <span style="color:#FF9500; font-weight:600;">R$ ${resumo.wagner.totalFiado.toFixed(2)}</span></div>
              <div style="font-size:16px; margin-bottom:5px;">Servi√ßos: <span style="font-weight:600;">${resumo.wagner.totalServicos}</span></div>
            </div>
          </div>
          
          <div style="margin-top:15px; padding-top:15px; border-top:1px solid rgba(255,255,255,0.1);">
            <h5 style="color:#9933ff; margin-bottom:10px;">TOTAIS GERAIS</h5>
            <div style="font-size:18px; margin-bottom:5px; font-weight:600;">Total Recebido: <span style="color:#25D366;">R$ ${resumo.geral.totalPago.toFixed(2)}</span></div>
            <div style="font-size:16px; margin-bottom:5px;">Total Fiado: <span style="color:#FF9500;">R$ ${resumo.geral.totalFiado.toFixed(2)}</span></div>
            <div style="font-size:16px; margin-bottom:5px;">Total Servi√ßos: <span style="font-weight:600;">${resumo.geral.totalServicos}</span></div>
          </div>
        </div>
        
        <div style="background:rgba(255,255,255,0.05);border-radius:12px;padding:20px;margin:15px 0;border-left:4px solid #9933ff;">
          <h4 style="color:#9933ff; margin-bottom:15px;">DETALHES POR SERVI√áO</h4>
          ${detalhesHTML || '<p style="text-align:center;color:#666;">Nenhum servi√ßo registrado hoje</p>'}
        </div>
        
        <div style="background:rgba(255,255,255,0.05);border-radius:12px;padding:20px;margin:15px 0;border-left:4px solid #9933ff;">
          <h4 style="color:#9933ff; margin-bottom:15px;">RESUMO DO M√äS - ${new Date().toLocaleDateString('pt-BR', {month: 'long', year: 'numeric'})}</h4>
          
          <div style="display:flex; gap:15px; flex-wrap:wrap;">
            <div style="flex:1; min-width:200px;">
              <h5 style="color:#ffaa00; margin-bottom:10px;">GABRIEL</h5>
              <div style="font-size:16px; margin-bottom:5px;">Total: <span style="font-weight:600;">R$ ${totalGabrielMes.toFixed(2)}</span></div>
              <div style="font-size:16px; margin-bottom:5px;">Servi√ßos: <span style="font-weight:600;">${servicosGabrielMes.length}</span></div>
            </div>
            
            <div style="flex:1; min-width:200px;">
              <h5 style="color:#ffaa00; margin-bottom:10px;">WAGNER</h5>
              <div style="font-size:16px; margin-bottom:5px;">Total: <span style="font-weight:600;">R$ ${totalWagnerMes.toFixed(2)}</span></div>
              <div style="font-size:16px; margin-bottom:5px;">Servi√ßos: <span style="font-weight:600;">${servicosWagnerMes.length}</span></div>
            </div>
          </div>
          
          <div style="margin-top:15px; padding-top:15px; border-top:1px solid rgba(255,255,255,0.1);">
            <h5 style="color:#9933ff; margin-bottom:10px;">TOTAIS DO M√äS</h5>
            <div style="font-size:18px; margin-bottom:5px; font-weight:600;">Faturamento: <span style="color:#25D366;">R$ ${(totalGabrielMes + totalWagnerMes).toFixed(2)}</span></div>
            <div style="font-size:16px; margin-bottom:5px;">Despesas: <span style="color:#ff3366;">R$ ${despesasMes.toFixed(2)}</span></div>
            <div style="font-size:18px; margin-bottom:5px; font-weight:600;">Lucro: <span style="color:#25D366;">R$ ${lucroMes.toFixed(2)}</span></div>
          </div>
        </div>
      `;
      
      container.innerHTML = html;
    }

    function calcularResumoCompleto() {
      const hoje = new Date().toISOString().split('T')[0];
      const servicosGabriel = dados.Gabriel.filter(s => s.data === hoje);
      const servicosWagner = dados.Wagner.filter(s => s.data === hoje);

      const totalGabrielPago = servicosGabriel.reduce((acc, s) => acc + (s.pago ? s.valor : 0), 0);
      const totalGabrielFiado = servicosGabriel.reduce((acc, s) => acc + (!s.pago ? s.valor : 0), 0);
      
      const totalWagnerPago = servicosWagner.reduce((acc, s) => acc + (s.pago ? s.valor : 0), 0);
      const totalWagnerFiado = servicosWagner.reduce((acc, s) => acc + (!s.pago ? s.valor : 0), 0);

      return {
        gabriel: {
          totalPago: totalGabrielPago,
          totalFiado: totalGabrielFiado,
          totalServicos: servicosGabriel.length
        },
        wagner: {
          totalPago: totalWagnerPago,
          totalFiado: totalWagnerFiado,
          totalServicos: servicosWagner.length
        },
        geral: {
          totalPago: totalGabrielPago + totalWagnerPago,
          totalFiado: totalGabrielFiado + totalWagnerFiado,
          totalServicos: servicosGabriel.length + servicosWagner.length
        }
      };
    }

    function abrirModalPagamentos() {
      document.getElementById('modalPagamentos').style.display = 'flex';
      gerarRelatorioPagamentos();
    }

    function gerarRelatorioPagamentos() {
      const dataInicio = document.getElementById('dataInicioPagamentos').value;
      const dataFim = document.getElementById('dataFimPagamentos').value;
      
      const container = document.getElementById('relatorioPagamentos');
      
      const todosServicos = [...dados.Gabriel, ...dados.Wagner];
      const servicosFiltrados = todosServicos.filter(s => {
        return s.data >= dataInicio && s.data <= dataFim && s.pago;
      });
      
      if (servicosFiltrados.length === 0) {
        container.innerHTML = '<p style="text-align:center;color:#666;padding:30px;">Nenhum pagamento encontrado no per√≠odo selecionado</p>';
        return;
      }
      
      const totais = {
        dinheiro: 0,
        pix: 0,
        debito: 0,
        credito: 0,
        total: 0
      };
      
      servicosFiltrados.forEach(servico => {
        if (servico.metodoPagamento && servico.pago) {
          totais[servico.metodoPagamento] += servico.valor;
          totais.total += servico.valor;
        }
      });
      
      let html = `
        <div style="background:rgba(255,255,255,0.05);border-radius:12px;padding:20px;margin-bottom:20px;">
          <h4 style="color:#ffaa00; margin-bottom:15px; text-align:center;">TOTAIS POR M√âTODO DE PAGAMENTO</h4>
          <div style="display:grid; grid-template-columns:repeat(2,1fr); gap:15px;">
            <div style="text-align:center;">
              <div style="font-size:14px;color:#aaa;">DINHEIRO</div>
              <div style="font-size:18px;font-weight:700;color:#ffaa00;">R$ ${totais.dinheiro.toFixed(2)}</div>
            </div>
            <div style="text-align:center;">
              <div style="font-size:14px;color:#aaa;">PIX</div>
              <div style="font-size:18px;font-weight:700;color:#25D366;">R$ ${totais.pix.toFixed(2)}</div>
            </div>
            <div style="text-align:center;">
              <div style="font-size:14px;color:#aaa;">D√âBITO</div>
              <div style="font-size:18px;font-weight:700;color:#3366ff;">R$ ${totais.debito.toFixed(2)}</div>
            </div>
            <div style="text-align:center;">
              <div style="font-size:14px;color:#aaa;">CR√âDITO</div>
              <div style="font-size:18px;font-weight:700;color:#9933ff;">R$ ${totais.credito.toFixed(2)}</div>
            </div>
          </div>
          <div style="text-align:center; margin-top:15px; padding-top:15px; border-top:1px solid rgba(255,255,255,0.1);">
            <div style="font-size:14px;color:#aaa;">TOTAL GERAL</div>
            <div style="font-size:24px;font-weight:700;color:#ffaa00;">R$ ${totais.total.toFixed(2)}</div>
          </div>
        </div>
        
        <h4 style="color:#ffaa00; margin:20px 0 10px;">DETALHES DOS PAGAMENTOS</h4>
        <table>
          <tr>
            <th>Data</th>
            <th>Barbeiro</th>
            <th>Servi√ßo</th>
            <th>Valor</th>
            <th>Metodo</th>
          </tr>
      `;

      servicosFiltrados.sort((a, b) => new Date(b.data + ' ' + b.hora) - new Date(a.data + ' ' + a.hora));

      servicosFiltrados.forEach(servico => {
        const barbeiro = dados.Gabriel.includes(servico) ? 'Gabriel' : 'Wagner';
        let metodoIcon = '';
        let metodoTexto = '';
        switch(servico.metodoPagamento) {
          case 'dinheiro': metodoIcon = 'üíµ'; metodoTexto = 'Dinheiro'; break;
          case 'pix': metodoIcon = 'üì±'; metodoTexto = 'PIX'; break;
          case 'debito': metodoIcon = 'üí≥'; metodoTexto = 'D√©bito'; break;
          case 'credito': metodoIcon = 'üí≥'; metodoTexto = 'Cr√©dito'; break;
        }

        html += `
          <tr>
            <td>${servico.data}<br><small>${servico.hora}</small></td>
            <td>${barbeiro}</td>
            <td>${servico.tipo}</td>
            <td>R$ ${servico.valor.toFixed(2)}</td>
            <td>${metodoIcon} ${metodoTexto}</td>
          </tr>
        `;
      });

      html += `</table>`;
      container.innerHTML = html;
    }

    function filtrarPagamentos() {
      gerarRelatorioPagamentos();
    }

    function enviarRelatorioPagamentosWhatsApp() {
      const dataInicio = document.getElementById('dataInicioPagamentos').value;
      const dataFim = document.getElementById('dataFimPagamentos').value;
      const periodo = dataInicio === dataFim 
        ? `dia ${formatarDataBrasileira(dataInicio)}` 
        : `per√≠odo ${formatarDataBrasileira(dataInicio)} a ${formatarDataBrasileira(dataFim)}`;

      const todosServicos = [...dados.Gabriel, ...dados.Wagner].filter(s => 
        s.data >= dataInicio && s.data <= dataFim && s.pago
      );

      if (todosServicos.length === 0) {
        alert('Nenhum pagamento no per√≠odo selecionado!');
        return;
      }

      const totais = {
        dinheiro: 0, pix: 0, debito: 0, credito: 0, total: 0
      };

      todosServicos.forEach(s => {
        if (s.metodoPagamento && s.pago) {
          totais[s.metodoPagamento] += s.valor;
          totais.total += s.valor;
        }
      });

      const mensagem = `*RELAT√ìRIO DE PAGAMENTOS*\n` +
        `Per√≠odo: ${periodo}\n\n` +
        `üíµ Dinheiro: R$ ${totais.dinheiro.toFixed(2)}\n` +
        `üì± PIX: R$ ${totais.pix.toFixed(2)}\n` +
        `üí≥ D√©bito: R$ ${totais.debito.toFixed(2)}\n` +
        `üí≥ Cr√©dito: R$ ${totais.credito.toFixed(2)}\n\n` +
        `üí∞ *TOTAL RECEBIDO: R$ ${totais.total.toFixed(2)}*`;

      const url = `https://wa.me/${config.whatsapp}?text=${encodeURIComponent(mensagem)}`;
      window.open(url, '_blank');
    }

    function abrirModalDespesas() {
      document.getElementById('modalDespesas').style.display = 'flex';
      listarDespesasModal();
    }

    function listarDespesasModal() {
      const container = document.getElementById('listaDespesas');
      if (dados.despesas.length === 0) {
        container.innerHTML = '<p style="text-align:center;color:#666;padding:30px;">Nenhuma despesa cadastrada este m√™s</p>';
        return;
      }

      const mesAtual = new Date().getMonth();
      const anoAtual = new Date().getFullYear();
      const despesasMes = dados.despesas.filter(d => {
        const data = new Date(d.data);
        return data.getMonth() === mesAtual && data.getFullYear() === anoAtual;
      });

      const totalDespesas = despesasMes.reduce((acc, d) => acc + d.valor, 0);

      let html = `<div style="margin-bottom:15px; padding:12px; background:rgba(255,50,50,0.15); border-radius:10px; text-align:center;">
        <div style="color:#ff3366; font-size:18px; font-weight:700;">Total de Despesas do M√™s: R$ ${totalDespesas.toFixed(2)}</div>
      </div>`;

      despesasMes.sort((a, b) => new Date(b.data) - new Date(a.data)).forEach((d, i) => {
        html += `
          <div class="despesa-item">
            <div>
              <div style="font-weight:600;">${d.desc}</div>
              <div style="font-size:12px;color:#aaa;">${formatarDataBrasileira(d.data)}</div>
            </div>
            <div style="display:flex; align-items:center; gap:10px;">
              <div class="despesa-valor">R$ ${d.valor.toFixed(2)}</div>
              <button class="action-btn" onclick="excluirDespesa(${i})">√ó</button>
            </div>
          </div>
        `;
      });

      container.innerHTML = html;
    }

    async function adicionarDespesa() {
      const desc = document.getElementById('descDespesa').value.trim();
      const valorStr = document.getElementById('valorDespesa').value;
      
      if (!desc || !valorStr) {
        alert('Preencha descri√ß√£o e valor!');
        return;
      }

      const valor = parseFloat(valorStr);
      if (isNaN(valor) || valor <= 0) {
        alert('Valor inv√°lido!');
        return;
      }

      const hoje = new Date().toISOString().split('T')[0];
      dados.despesas.push({ desc, valor, data: hoje });
      await salvarDados();
      document.getElementById('descDespesa').value = '';
      document.getElementById('valorDespesa').value = '';
      listarDespesasModal();
      atualizarListaDespesas();
      atualizarDashboard();
      alert('Despesa adicionada com sucesso!');
    }

    async function excluirDespesa(index) {
      if (confirm('Excluir esta despesa?')) {
        dados.despesas.splice(index, 1);
        await salvarDados();
        listarDespesasModal();
        atualizarListaDespesas();
        atualizarDashboard();
      }
    }

    function abrirModalMensalistas() {
      document.getElementById('modalMensalistas').style.display = 'flex';
      listarMensalistasModal();
    }

    function listarMensalistasModal() {
      const container = document.getElementById('listaMensalistasModal');
      
      if (dados.mensalistas.length === 0) {
        container.innerHTML = '<p style="text-align:center;color:#666;padding:30px;">Nenhum mensalista cadastrado</p>';
        return;
      }
      
      const dataInicio = document.getElementById('dataInicioMensalistas').value;
      const dataFim = document.getElementById('dataFimMensalistas').value;
      
      const mensalistasFiltrados = dados.mensalistas.filter(m => {
        return m.dataInicio >= dataInicio && m.dataInicio <= dataFim;
      });
      
      if (mensalistasFiltrados.length === 0) {
        container.innerHTML = '<p style="text-align:center;color:#666;padding:30px;">Nenhum mensalista encontrado no per√≠odo selecionado</p>';
        return;
      }
      
      const totalMensalistas = mensalistasFiltrados.length;
      const totalValor = mensalistasFiltrados.reduce((acc, m) => acc + m.valor, 0);
      const totalPagos = mensalistasFiltrados.filter(m => m.status === 'pago').length;
      const totalPendentes = mensalistasFiltrados.filter(m => m.status === 'pendente').length;
      
      let html = `
        <div style="background:rgba(255,255,255,0.05);border-radius:12px;padding:20px;margin-bottom:20px;">
          <h4 style="color:#00cc99; margin-bottom:15px; text-align:center;">RESUMO DE MENSALISTAS</h4>
          <div style="display:grid; grid-template-columns:repeat(2,1fr); gap:15px;">
            <div style="text-align:center;">
              <div style="font-size:14px;color:#aaa;">TOTAL</div>
              <div style="font-size:18px;font-weight:700;color:#00cc99;">${totalMensalistas}</div>
            </div>
            <div style="text-align:center;">
              <div style="font-size:14px;color:#aaa;">VALOR TOTAL</div>
              <div style="font-size:18px;font-weight:700;color:#00cc99;">R$ ${totalValor.toFixed(2)}</div>
            </div>
            <div style="text-align:center;">
              <div style="font-size:14px;color:#aaa;">PAGOS</div>
              <div style="font-size:18px;font-weight:700;color:#25D366;">${totalPagos}</div>
            </div>
            <div style="text-align:center;">
              <div style="font-size:14px;color:#aaa;">PENDENTES</div>
              <div style="font-size:18px;font-weight:700;color:#FF9500;">${totalPendentes}</div>
            </div>
          </div>
        </div>
        
        <h4 style="color:#00cc99; margin:20px 0 10px;">LISTA DE MENSALISTAS</h4>
      `;
      
      mensalistasFiltrados.sort((a, b) => new Date(b.dataInicio) - new Date(a.dataInicio)).forEach((mensalista, index) => {
        const statusClass = mensalista.status === 'pago' ? 'status-pago' : 'status-pendente';
        const statusText = mensalista.status === 'pago' ? 'PAGO' : 'PENDENTE';
        
        html += `
          <div class="mensalista-card">
            <div class="mensalista-header">
              <div class="mensalista-nome">${mensalista.nome}</div>
              <div class="mensalista-status ${statusClass}">${statusText}</div>
            </div>
            <div class="mensalista-detalhes">
              <div>Valor: <span class="mensalista-valor">R$ ${mensalista.valor.toFixed(2)}</span></div>
              <div>Vencimento: dia ${mensalista.vencimento}</div>
              <div>In√≠cio: ${formatarDataBrasileira(mensalista.dataInicio)}</div>
              <div>Status: ${mensalista.status === 'pago' ? '‚úÖ Pago' : '‚è≥ Pendente'}</div>
            </div>
            <div style="margin-top:10px; display:flex; gap:10px;">
              <button class="action-btn" style="background:#25D366;" onclick="alterarStatusMensalista(${index})">‚úì</button>
              <button class="action-btn" onclick="excluirMensalista(${index})">√ó</button>
            </div>
          </div>
        `;
      });
      
      container.innerHTML = html;
    }

    function filtrarMensalistas() {
      listarMensalistasModal();
    }

    async function adicionarMensalista() {
      const nome = document.getElementById('nomeMensalista').value.trim();
      const valorStr = document.getElementById('valorMensalista').value;
      const vencimento = document.getElementById('vencimentoMensalista').value;
      const status = document.getElementById('statusMensalista').value;
      
      if (!nome || !valorStr || !vencimento) {
        alert('Preencha todos os campos!');
        return;
      }

      const valor = parseFloat(valorStr);
      if (isNaN(valor) || valor <= 0) {
        alert('Valor inv√°lido!');
        return;
      }

      if (vencimento < 1 || vencimento > 31) {
        alert('Dia de vencimento deve ser entre 1 e 31!');
        return;
      }

      const hoje = new Date().toISOString().split('T')[0];
      dados.mensalistas.push({ 
        nome, 
        valor, 
        vencimento: parseInt(vencimento), 
        status,
        dataInicio: hoje
      });
      
      await salvarDados();
      
      document.getElementById('nomeMensalista').value = '';
      document.getElementById('valorMensalista').value = '';
      document.getElementById('vencimentoMensalista').value = '';
      document.getElementById('statusMensalista').value = 'pago';
      
      listarMensalistasModal();
      atualizarListaMensalistas();
      alert('Mensalista adicionado com sucesso!');
    }

    async function alterarStatusMensalista(index) {
      const mensalista = dados.mensalistas[index];
      mensalista.status = mensalista.status === 'pago' ? 'pendente' : 'pago';
      await salvarDados();
      listarMensalistasModal();
      atualizarListaMensalistas();
    }

    async function excluirMensalista(index) {
      if (confirm('Tem certeza que deseja excluir este mensalista?')) {
        dados.mensalistas.splice(index, 1);
        await salvarDados();
        listarMensalistasModal();
        atualizarListaMensalistas();
        alert('Mensalista exclu√≠do com sucesso!');
      }
    }

    function abrirModalConfiguracoes() {
      document.getElementById('modalConfig').style.display = 'flex';
      document.getElementById('numWhats').value = config.whatsapp;
      document.getElementById('corteAtual').textContent = config.corte.toFixed(2);
      document.getElementById('barbaAtual').textContent = config.barba.toFixed(2);
      document.getElementById('comboAtual').textContent = config.combo.toFixed(2);
      document.getElementById('valCorte').value = '';
      document.getElementById('valBarba').value = '';
      document.getElementById('valCombo').value = '';
      document.getElementById('novoPin').value = '';
    }

    async function salvarConfiguracoes() {
      const numWhats = document.getElementById('numWhats').value.replace(/\D/g, '');
      const novoPin = document.getElementById('novoPin').value;

      if (numWhats && numWhats.length >= 10) {
        config.whatsapp = numWhats;
      }

      if (novoPin && novoPin.length === 4 && /^\d+$/.test(novoPin)) {
        config.pin = novoPin;
        alert('PIN alterado com sucesso!');
      }

      const valCorte = parseFloat(document.getElementById('valCorte').value);
      const valBarba = parseFloat(document.getElementById('valBarba').value);
      const valCombo = parseFloat(document.getElementById('valCombo').value);

      if (!isNaN(valCorte) && valCorte > 0) config.corte = valCorte;
      if (!isNaN(valBarba) && valBarba > 0) config.barba = valBarba;
      if (!isNaN(valCombo) && valCombo > 0) config.combo = valCombo;

      await salvarDados();
      alert('Configura√ß√µes salvas com sucesso!');
      fecharModal('modalConfig');
    }

    function enviarResumoWhatsApp() {
      const resumo = calcularResumoCompleto();
      const hoje = new Date().toLocaleDateString('pt-BR');
      
      const mensagem = `*RESUMO DO DIA - BarbaPRO Duo*\n` +
        `${hoje}\n\n` +
        `*GABRIEL*\n` +
        `Recebido: R$ ${resumo.gabriel.totalPago.toFixed(2)}\n` +
        `Fiado: R$ ${resumo.gabriel.totalFiado.toFixed(2)}\n` +
        `Servi√ßos: ${resumo.gabriel.totalServicos}\n\n` +
        `*WAGNER*\n` +
        `Recebido: R$ ${resumo.wagner.totalPago.toFixed(2)}\n` +
        `Fiado: R$ ${resumo.wagner.totalFiado.toFixed(2)}\n` +
        `Servi√ßos: ${resumo.wagner.totalServicos}\n\n` +
        `*TOTAL DO DIA*\n` +
        `Recebido: R$ ${resumo.geral.totalPago.toFixed(2)}\n` +
        `Fiado: R$ ${resumo.geral.totalFiado.toFixed(2)}\n` +
        `Servi√ßos: ${resumo.geral.totalServicos}`;

      const url = `https://wa.me/${config.whatsapp}?text=${encodeURIComponent(mensagem)}`;
      window.open(url, '_blank');
    }

    function fecharModal(id) {
      document.getElementById(id).style.display = 'none';
    }

    function formatarDataBrasileira(dataISO) {
      const [ano, mes, dia] = dataISO.split('-');
      return `${dia}/${mes}/${ano}`;
    }

    // Fechar modal ao clicar fora
    document.querySelectorAll('.modal').forEach(modal => {
      modal.addEventListener('click', function(e) {
        if (e.target === this) {
          this.style.display = 'none';
        }
      });
    });
  </script>
</body>
</html>